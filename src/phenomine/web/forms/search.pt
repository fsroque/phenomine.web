<div class="row">
	<div class="span3 offset2 logo">
	  <img  id='logo' tal:attributes="src static/mining.png" width="175px" height="87px" alt="logo" />
	</div>
	<div class='span4' id="form">
	  <form action="." tal:attributes="action request/URL" method="post" class="edit-form form-inline" enctype="multipart/form-data">
		<div class="control-group">
		    <textarea placeholder="Input phenotypes" tal:content="view/getPhenotypeInput" name="form.phenotypes" id="form.phenotypes" class="span3" rows="1">
		    </textarea>
 	    </div>
		
		<div class="control-group">
		<!--	
        <label class="control-label">Use textmining?</label>
        <select class="span1" id="form.search" name="form.search" size="1" tal:define="current view/getSearchInput">
          <option tal:attributes="selected python:'no'==current" value="no">no</option>
          <option tal:attributes="selected python:'partial'==current" value="partial">partial</option>
          <option tal:attributes="selected python:'full'==current" value="full">full</option>
        </select>
		
		-->
		<div class="controls" id="form.search" name="form.search" tal:define="current view/getSearchInput">
			<label class="control-label"><strong>Textmining:</strong></label>
			<label class="radio">
				<input type="radio" name="optionsSearch" value="no" checked>
				<span class="muted">None</span>
			</label>
			<label class="radio">
				<input type="radio" name="optionsSearch" tal:attributes="checked python:'partial'==current" value="partial">
				<span class="muted">Partial</span>
			</label>
			<label class="radio">
				<input type="radio" name="optionsSearch" tal:attributes="checked python:'full'==current" value="full">
				<span class="muted">Full</span>
			</label>
		</div>
		
		</div>
		<div class="control-group row">
		<div class="span3 pagination-centered">
          <input tal:replace="structure python: view.actions['form.actions.searchHome'].render()" />
          <input tal:replace="structure python: view.actions['form.actions.clearHome'].render()" />
        </div>
		</div>
	  </form>
	</div>
</div>



<div class="row" tal:define="status view/status" tal:condition="status">
	<div class="span5 offset3 alert alert-error form-status">
	  <div class="error text">
	    <div tal:condition="view/errors" tal:replace="structure python: view.errors[0]" />
	  </div>
	</div>
</div>

<div class="row">
	
	<div tal:condition="not: view/hasResult" tal:on-error="structure string:<div class='span6 offset3 alert '><strong>phenomine</strong> is down for maintenance, please check back later.</div><script type='text/javascript'>disableButtons()</script>">

		<div class="span10 offset1">
		  <script type='text/javascript'>enableButtons()</script>
		  <div id="about-and-instructions" class="span9 well">
		    <h2>About and Instructions</h2>
		    <p>Phenomine is a search engine for the Online Mendelian Inheritance in Man&reg; database. It 
		      provides extra functionality to extract genes related to several phenotypes at once, or to extend 
		      gene-phenotype associations by taking advantage of free-text search in the phenotype text.
		    </p>

		    <p>The database was last updated on <strong tal:content="view/getLastUpdate"></strong> with the latest
		      OMIM&reg; and Ensembl content. Gene to phenotype association is derived from Ensembl.
		    </p>

		    <p><strong>Instructions:</strong><br />
		      <dl>
		       <dd>Input phenotypes in the box above, one per line.</dd><br />
		       <dd>If you choose not to use text-mining, the server will only output genes which are directly 
		       associated with a given phenotype in morbidmap. Phenotypes are matched only by name.</dd><br />
		       <dd>Choosing 'partial' text-mining will extend the search to include the phenotype description text.
		       Any occurrence of the phenotype in an OMIM entry, will return the gene related to the latter. In
		       this way you can retrieve genes that are indirectly associated to a phenotype. Only phenotypes for
		       which the molecular basis is known ('#' prefix in OMIM) are included.</dd><br />
		       <dd>If you select 'full' text-mining, the partial search is extended to include phenotypes or loci
			for which the underlying molecular basis is not known ('%' prefix in OMIM).</dd>
		      </dl>
		  </div>
		</div>
	</div>

	<div tal:condition="view/hasResult">
	  <div tal:condition="python: len(view.getResult())>0" class="span12">
	    <table id="results" class="table table-striped table-bordered table-condensed">
	      <caption tal:content="structure view/tableHeader" />
	      <thead>
	      <tr tal:condition="python: view.getSearchInput() == 'no'">
	        <th>Matched phenotype</th>
	        <th>Matched morbid</th>
	        <th>Ensembl Gene Id</th>
	        <th>MIM Id</th>
	        <th>HGNC symbol</th>
	      </tr>
	      <tr tal:condition="python: view.getSearchInput() != 'no'">
	        <th>Matched phenotype</th>
	        <th>Matched morbid</th>
	        <th>Ensembl Gene Id</th>
	        <th>MIM Id</th>
	        <th>HGNC symbol</th>
	        <th>Match context</th>
	      </tr>
	      </thead>
	      <tbody>
	      <tr class="gene" tal:repeat="result view/getResult" tal:condition="python: view.getSearchInput() == 'no'">  
	        <td class="phenotype" tal:content="result/phenotype">Phenotype</td>
	        <td class="morbid" tal:content="structure python: view.returnMorbid(result['matched_morbid'])">Morbid</td>
	        <td class="ensembl" tal:content="structure python: '<a href=\'http://www.ensembl.org/Homo_sapiens/Gene/Summary?g=%s\' target=\'_blank\'>%s</a>' % (result['ensembl'],result['ensembl'])">Ensembl</td>
	        <td class="mim" tal:content="structure python: '<a href=\'http://www.omim.org/entry/%s\' target=\'_blank\'>%s</a>' % (result['mim'],result['mim'])">Mim</td>
	        <td class="append-2 last hgnc" tal:content="result/hgnc">HGNC</td>
	      </tr>
	      <tr class="gene" tal:repeat="result view/getResult" tal:condition="python: view.getSearchInput() != 'no'">  
	        <td class="phenotype" tal:content="result/phenotype">Phenotype</td>
	        <td class="morbid" tal:content="structure python: view.returnMorbid(result['matched_morbid'])">Morbid</td>
	        <td class="ensembl" tal:content="structure python: '<a href=\'http://www.ensembl.org/Homo_sapiens/Gene/Summary?g=%s\' target=\'_blank\'>%s</a>' % (result['ensembl'],result['ensembl'])">Ensembl</td>
	        <td class="mim" tal:content="structure python: '<a href=\'http://www.omim.org/entry/%s\' target=\'_blank\'>%s</a>' % (result['mim'],result['mim'])">Mim</td>
	        <td class="hgnc" tal:content="result/hgnc">HGNC</td>
	        <td class="last context" tal:content="structure result/match">Match</td>
	      </tr>
	      </tbody>
	    </table> 
	  </div>
	  <div class="span3 offset4 alert" tal:condition="python: len(view.getResult())==0">
	      <strong>Warning:</strong> No results found
	  </div>
	</div> 
</div>

  


